/*! jQuery contextMenu - Plugin for simple contextMenu handling 1.6.5 | Authors: Rodney Rehm, Addy Osmani | http://medialize.github.com/jQuery-contextMenu/ | Licensed under MIT License opensource.org/licenses/mit-license And GPL v3 opensource.org/licenses/GPL-3.0 */
(function(c,s){function E(c,f,g){return[parseInt(c[0],10)*(y.test(c[0])?f/100:1),parseInt(c[1],10)*(y.test(c[1])?g/100:1)]}function w(h){var f=h[0];return 9===f.nodeType?{width:h.width(),height:h.height(),offset:{top:0,left:0}}:c.isWindow(f)?{width:h.width(),height:h.height(),offset:{top:h.scrollTop(),left:h.scrollLeft()}}:f.preventDefault?{width:0,height:0,offset:{top:f.pageY,left:f.pageX}}:{width:h.outerWidth(),height:h.outerHeight(),offset:h.offset()}}c.ui=c.ui||{};var z,A=Math.max,n=Math.abs,B=Math.round,t=/left|center|right/,C=/top|center|bottom/,r=/[\+\-]\d+%?/,p=/^\w+/,y=/%$/,D=c.fn.position;c.position={scrollbarWidth:function(){if(z!==s)return z;var h,f,g=c("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>");f=g.children()[0];c("body").append(g);h=f.offsetWidth;g.css("overflow","scroll");f=f.offsetWidth;h===f&&(f=g[0].clientWidth);g.remove();return z=h-f},getScrollInfo:function(h){var f=h.isWindow?"":h.element.css("overflow-x"),g=h.isWindow?"":h.element.css("overflow-y"),g="scroll"===g||"auto"===g&&h.height<h.element[0].scrollHeight;return{width:"scroll"===f||"auto"===f&&h.width<h.element[0].scrollWidth?c.position.scrollbarWidth():0,height:g?c.position.scrollbarWidth():0}},getWithinInfo:function(h){h=c(h||window);var f=c.isWindow(h[0]);return{element:h,isWindow:f,offset:h.offset()||{left:0,top:0},scrollLeft:h.scrollLeft(),scrollTop:h.scrollTop(),width:f?h.width():h.outerWidth(),height:f?h.height():h.outerHeight()}}};c.fn.position=function(h){if(!h||!h.of)return D.apply(this,arguments);h=c.extend({},h);var f,g,m,v,k,l,a=c(h.of),b=c.position.getWithinInfo(h.within),e=c.position.getScrollInfo(b),d=(h.collision||"flip").split(" "),u={};l=w(a);a[0].preventDefault&&(h.at="left top");g=l.width;m=l.height;v=l.offset;k=c.extend({},v);c.each(["my","at"],function(){var a=(h[this]||"").split(" "),b,d;1===a.length&&(a=t.test(a[0])?a.concat(["center"]):C.test(a[0])?["center"].concat(a):["center","center"]);a[0]=t.test(a[0])?a[0]:"center";a[1]=C.test(a[1])?a[1]:"center";b=r.exec(a[0]);d=r.exec(a[1]);u[this]=[b?b[0]:0,d?d[0]:0];h[this]=[p.exec(a[0])[0],p.exec(a[1])[0]]});1===d.length&&(d[1]=d[0]);"right"===h.at[0]?k.left+=g:"center"===h.at[0]&&(k.left+=g/2);"bottom"===h.at[1]?k.top+=m:"center"===h.at[1]&&(k.top+=m/2);f=E(u.at,g,m);k.left+=f[0];k.top+=f[1];return this.each(function(){var F,G,l=c(this),p=l.outerWidth(),x=l.outerHeight(),H=parseInt(c.css(this,"marginLeft"),10)||0,I=parseInt(c.css(this,"marginTop"),10)||0,s=p+H+(parseInt(c.css(this,"marginRight"),10)||0)+e.width,t=x+I+(parseInt(c.css(this,"marginBottom"),10)||0)+e.height,q=c.extend({},k),r=E(u.my,l.outerWidth(),l.outerHeight());"right"===h.my[0]?q.left-=p:"center"===h.my[0]&&(q.left-=p/2);"bottom"===h.my[1]?q.top-=x:"center"===h.my[1]&&(q.top-=x/2);q.left+=r[0];q.top+=r[1];c.support.offsetFractions||(q.left=B(q.left),q.top=B(q.top));F={marginLeft:H,marginTop:I};c.each(["left","top"],function(a,e){if(c.ui.position[d[a]])c.ui.position[d[a]][e](q,{targetWidth:g,targetHeight:m,elemWidth:p,elemHeight:x,collisionPosition:F,collisionWidth:s,collisionHeight:t,offset:[f[0]+r[0],f[1]+r[1]],my:h.my,at:h.at,within:b,elem:l})});h.using&&(G=function(b){var d=v.left-q.left,e=d+g-p,c=v.top-q.top,f=c+m-x,u={target:{element:a,left:v.left,top:v.top,width:g,height:m},element:{element:l,left:q.left,top:q.top,width:p,height:x},horizontal:0>e?"left":0<d?"right":"center",vertical:0>f?"top":0<c?"bottom":"middle"};g<p&&n(d+e)<g&&(u.horizontal="center");m<x&&n(c+f)<m&&(u.vertical="middle");A(n(d),n(e))>A(n(c),n(f))?u.important="horizontal":u.important="vertical";h.using.call(this,b,u)});l.offset(c.extend(q,{using:G}))})};c.ui.position={fit:{left:function(c,f){var g=f.within,m=g.isWindow?g.scrollLeft:g.offset.left,n=g.width,k=c.left-f.collisionPosition.marginLeft,g=m-k,l=k+f.collisionWidth-n-m;f.collisionWidth>n?0<g&&0>=l?(m=c.left+g+f.collisionWidth-n-m,c.left+=g-m):c.left=0<l&&0>=g?m:g>l?m+n-f.collisionWidth:m:c.left=0<g?c.left+g:0<l?c.left-l:A(c.left-k,c.left)},top:function(c,f){var g=f.within,m=g.isWindow?g.scrollTop:g.offset.top,n=f.within.height,k=c.top-f.collisionPosition.marginTop,g=m-k,l=k+f.collisionHeight-n-m;f.collisionHeight>n?0<g&&0>=l?(m=c.top+g+f.collisionHeight-n-m,c.top+=g-m):c.top=0<l&&0>=g?m:g>l?m+n-f.collisionHeight:m:c.top=0<g?c.top+g:0<l?c.top-l:A(c.top-k,c.top)}},flip:{left:function(c,f){var g=f.within,m=g.offset.left+g.scrollLeft,p=g.width,k=g.isWindow?g.scrollLeft:g.offset.left,l=c.left-f.collisionPosition.marginLeft,g=l-k,a=l+f.collisionWidth-p-k,l="left"===f.my[0]?-f.elemWidth:"right"===f.my[0]?f.elemWidth:0,b="left"===f.at[0]?f.targetWidth:"right"===f.at[0]?-f.targetWidth:0,e=-2*f.offset[0];if(0>g){if(m=c.left+l+b+e+f.collisionWidth-p-m,0>m||m<n(g))c.left+=l+b+e}else 0<a&&(m=c.left-f.collisionPosition.marginLeft+l+b+e-k,0<m||n(m)<a)&&(c.left+=l+b+e)},top:function(c,f){var g=f.within,m=g.offset.top+g.scrollTop,p=g.height,k=g.isWindow?g.scrollTop:g.offset.top,l=c.top-f.collisionPosition.marginTop,g=l-k,a=l+f.collisionHeight-p-k,l="top"===f.my[1]?-f.elemHeight:"bottom"===f.my[1]?f.elemHeight:0,b="top"===f.at[1]?f.targetHeight:"bottom"===f.at[1]?-f.targetHeight:0,e=-2*f.offset[1];0>g?(m=c.top+l+b+e+f.collisionHeight-p-m,c.top+l+b+e>g&&(0>m||m<n(g))&&(c.top+=l+b+e)):0<a&&(m=c.top-f.collisionPosition.marginTop+l+b+e-k,c.top+l+b+e>a&&(0<m||n(m)<a)&&(c.top+=l+b+e))}},flipfit:{left:function(){c.ui.position.flip.left.apply(this,arguments);c.ui.position.fit.left.apply(this,arguments)},top:function(){c.ui.position.flip.top.apply(this,arguments);c.ui.position.fit.top.apply(this,arguments)}}};(function(){var h,f,g,m,n=document.getElementsByTagName("body")[0];g=document.createElement("div");h=document.createElement(n?"div":"body");f={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"};n&&c.extend(f,{position:"absolute",left:"-1000px",top:"-1000px"});for(m in f)h.style[m]=f[m];h.appendChild(g);f=n||document.documentElement;f.insertBefore(h,f.firstChild);g.style.cssText="position: absolute; left: 10.7432222px;";g=c(g).offset().left;c.support.offsetFractions=10<g&&11>g;h.innerHTML="";f.removeChild(h)})()})(jQuery);(function(c,s){function E(a){a=a.split(/\s+/);for(var b=[],c=0,d;d=a[c];c++)d=d[0].toUpperCase(),b.push(d);return b}function w(a){return a.id&&c('label[for="'+a.id+'"]').val()||a.name}function z(a,b,e){e||(e=0);b.each(function(){var b=c(this),f=this,g=this.nodeName.toLowerCase(),h,k;"label"==g&&b.find("input, textarea, select").length&&(h=b.text(),b=b.children().first(),f=b.get(0),g=f.nodeName.toLowerCase());switch(g){case "menu":k={name:b.attr("label"),items:{}};e=z(k.items,b.children(),e);break;case "a":case "button":k={name:b.text(),disabled:!!b.attr("disabled"),callback:function(){return function(){b.click()}}()};break;case "menuitem":case "command":switch(b.attr("type")){case s:case "command":case "menuitem":k={name:b.attr("label"),disabled:!!b.attr("disabled"),callback:function(){return function(){b.click()}}()};break;case "checkbox":k={type:"checkbox",disabled:!!b.attr("disabled"),name:b.attr("label"),selected:!!b.attr("checked")};break;case "radio":k={type:"radio",disabled:!!b.attr("disabled"),name:b.attr("label"),radio:b.attr("radiogroup"),value:b.attr("id"),selected:!!b.attr("checked")};break;default:k=s}break;case "hr":k="-------";break;case "input":switch(b.attr("type")){case "text":k={type:"text",name:h||w(f),disabled:!!b.attr("disabled"),value:b.val()};break;case "checkbox":k={type:"checkbox",name:h||w(f),disabled:!!b.attr("disabled"),selected:!!b.attr("checked")};break;case "radio":k={type:"radio",name:h||w(f),disabled:!!b.attr("disabled"),radio:!!b.attr("name"),value:b.val(),selected:!!b.attr("checked")};break;default:k=s}break;case "select":k={type:"select",name:h||w(f),disabled:!!b.attr("disabled"),selected:b.val(),options:{}};b.children().each(function(){k.options[this.value]=c(this).text()});break;case "textarea":k={type:"textarea",name:h||w(f),disabled:!!b.attr("disabled"),value:b.val()};break;case "label":break;default:k={type:"html",html:b.clone(!0)}}k&&(e++,a["key"+e]=k)});return e}c.support.htmlMenuitem="HTMLMenuItemElement"in window;c.support.htmlCommand="HTMLCommandElement"in window;c.support.eventSelectstart="onselectstart"in document.documentElement;if(!c.ui||!c.ui.widget){var A=c.cleanData;c.cleanData=function(a){for(var b=0,e;null!=(e=a[b]);b++)try{c(e).triggerHandler("remove")}catch(d){}A(a)}}var n=null,B=!1,t=c(window),C=0,r={},p={},y={},D={selector:null,appendTo:null,trigger:"right",autoHide:!1,delay:200,reposition:!0,determinePosition:function(a){if(c.ui&&c.ui.position)a.css("display","block").position({my:"center top",at:"center bottom",of:this,offset:"0 5",collision:"fit"}).css("display","none");else{var b=this.offset();b.top+=this.outerHeight();b.left+=this.outerWidth()/2-a.outerWidth()/2;a.css(b)}},position:function(a,b,c){if(b||c){b="maintain"===b&&"maintain"===c?a.$menu.position():{top:c,left:b};c=t.scrollTop()+t.height();var d=t.scrollLeft()+t.width(),f=a.$menu.height(),k=a.$menu.width();b.top+f>c&&(b.top-=f);b.left+k>d&&(b.left-=k);a.$menu.css(b)}else a.determinePosition.call(this,a.$menu)},positionSubmenu:function(a){if(c.ui&&c.ui.position)a.css("display","block").position({my:"left top",at:"right top",of:this,collision:"flipfit fit"}).css("display","");else{var b={top:0,left:this.outerWidth()};a.css(b)}},zIndex:1,animation:{duration:50,show:"slideDown",hide:"slideUp"},events:{show:c.noop,hide:c.noop},callback:null,items:{}},h=null,f=null,g=null,m,v=function(a){for(var b=0;b=Math.max(b,parseInt(a.css("z-index"),10)||0),a=a.parent(),a&&a.length&&!(-1<"html body".indexOf(a.prop("nodeName").toLowerCase())););return b},k={abortevent:function(a){a.preventDefault();a.stopImmediatePropagation()},contextmenu:function(a){var b=c(this);a.preventDefault();a.stopImmediatePropagation();if(!("right"!=a.data.trigger&&a.originalEvent||b.hasClass("context-menu-active")||b.hasClass("context-menu-disabled"))){n=b;if(a.data.build){var e=a.data.build(n,a);if(!1===e)return;a.data=c.extend(!0,{},D,a.data,e||{});if(!a.data.items||c.isEmptyObject(a.data.items))throw window.console&&(console.error||console.log)("No items specified to show in contextMenu"),Error("No Items sepcified");a.data.$trigger=n;l.create(a.data)}l.show.call(b,a.data,a.pageX,a.pageY)}},click:function(a){a.preventDefault();a.stopImmediatePropagation();c(this).trigger(c.Event("contextmenu",{data:a.data,pageX:a.pageX,pageY:a.pageY}))},mousedown:function(a){var b=c(this);n&&n.length&&!n.is(b)&&n.data("contextMenu").$menu.trigger("contextmenu:hide");2==a.button&&(n=b.data("contextMenuActive",!0))},mouseup:function(a){var b=c(this);b.data("contextMenuActive")&&n&&n.length&&n.is(b)&&!b.hasClass("context-menu-disabled")&&(a.preventDefault(),a.stopImmediatePropagation(),n=b,b.trigger(c.Event("contextmenu",{data:a.data,pageX:a.pageX,pageY:a.pageY})));b.removeData("contextMenuActive")},mouseenter:function(a){var b=c(this),e=c(a.relatedTarget),d=c(document);e.is(".context-menu-list")||e.closest(".context-menu-list").length||n&&n.length||(f=a.pageX,g=a.pageY,m=a.data,d.on("mousemove.contextMenuShow",k.mousemove),h=setTimeout(function(){h=null;d.off("mousemove.contextMenuShow");n=b;b.trigger(c.Event("contextmenu",{data:m,pageX:f,pageY:g}))},a.data.delay))},mousemove:function(a){f=a.pageX;g=a.pageY},mouseleave:function(a){a=c(a.relatedTarget);if(!a.is(".context-menu-list")&&!a.closest(".context-menu-list").length){try{clearTimeout(h)}catch(b){}h=null}},layerClick:function(a){var b=c(this).data("contextMenuRoot"),e=a.button,d=a.pageX,f=a.pageY,k,g;a.preventDefault();a.stopImmediatePropagation();setTimeout(function(){var h,l="left"==b.trigger&&0===e||"right"==b.trigger&&2===e;document.elementFromPoint&&(b.$layer.hide(),k=document.elementFromPoint(d-t.scrollLeft(),f-t.scrollTop()),b.$layer.show());if(b.reposition&&l)if(document.elementFromPoint){if(b.$trigger.is(k)||b.$trigger.has(k).length){b.position.call(b.$trigger,b,d,f);return}}else if(g=b.$trigger.offset(),h=c(window),g.top+=h.scrollTop(),g.top<=a.pageY&&(g.left+=h.scrollLeft(),g.left<=a.pageX&&(g.bottom=g.top+b.$trigger.outerHeight(),g.bottom>=a.pageY&&(g.right=g.left+b.$trigger.outerWidth(),g.right>=a.pageX)))){b.position.call(b.$trigger,b,d,f);return}if(k&&l)b.$trigger.one("contextmenu:hidden",function(){c(k).contextMenu({x:d,y:f})});b.$menu.trigger("contextmenu:hide")},50)},keyStop:function(a,b){b.isInput||a.preventDefault();a.stopPropagation()},key:function(a){var b=n.data("contextMenu")||{};switch(a.keyCode){case 9:case 38:if(k.keyStop(a,b),b.isInput){if(9==a.keyCode&&a.shiftKey){a.preventDefault();b.$selected&&b.$selected.find("input, textarea, select").blur();b.$menu.trigger("prevcommand");return}if(38==a.keyCode&&"checkbox"==b.$selected.find("input, textarea, select").prop("type")){a.preventDefault();return}}else if(9!=a.keyCode||a.shiftKey){b.$menu.trigger("prevcommand");return}case 40:k.keyStop(a,b);if(b.isInput){if(9==a.keyCode){a.preventDefault();b.$selected&&b.$selected.find("input, textarea, select").blur();b.$menu.trigger("nextcommand");return}if(40==a.keyCode&&"checkbox"==b.$selected.find("input, textarea, select").prop("type")){a.preventDefault();return}}else{b.$menu.trigger("nextcommand");return}break;case 37:k.keyStop(a,b);if(b.isInput||!b.$selected||!b.$selected.length)break;if(!b.$selected.parent().hasClass("context-menu-root")){a=b.$selected.parent().parent();b.$selected.trigger("contextmenu:blur");b.$selected=a;return}break;case 39:k.keyStop(a,b);if(b.isInput||!b.$selected||!b.$selected.length)break;var c=b.$selected.data("contextMenu")||{};if(c.$menu&&b.$selected.hasClass("context-menu-submenu")){b.$selected=null;c.$selected=null;c.$menu.trigger("nextcommand");return}break;case 35:case 36:b.$selected&&b.$selected.find("input, textarea, select").length||((b.$selected&&b.$selected.parent()||b.$menu).children(":not(.disabled, .not-selectable)")[36==a.keyCode?"first":"last"]().trigger("contextmenu:focus"),a.preventDefault());return;case 13:k.keyStop(a,b);if(b.isInput){if(b.$selected&&!b.$selected.is("textarea, select")){a.preventDefault();return}break}b.$selected&&b.$selected.trigger("mouseup");return;case 32:case 33:case 34:k.keyStop(a,b);return;case 27:k.keyStop(a,b);b.$menu.trigger("contextmenu:hide");return;default:if(c=String.fromCharCode(a.keyCode).toUpperCase(),b.accesskeys[c]){b.accesskeys[c].$node.trigger(b.accesskeys[c].$menu?"contextmenu:focus":"mouseup");return}}a.stopPropagation();b.$selected&&b.$selected.trigger(a)},prevItem:function(a){a.stopPropagation();var b=c(this).data("contextMenu")||{};if(b.$selected){var e=b.$selected,b=b.$selected.parent().data("contextMenu")||{};b.$selected=e}for(var e=b.$menu.children(),d=b.$selected&&b.$selected.prev().length?b.$selected.prev():e.last(),f=d;d.hasClass("disabled")||d.hasClass("not-selectable");)if(d=d.prev().length?d.prev():e.last(),d.is(f))return;b.$selected&&k.itemMouseleave.call(b.$selected.get(0),a);k.itemMouseenter.call(d.get(0),a);a=d.find("input, textarea, select");a.length&&a.focus()},nextItem:function(a){a.stopPropagation();var b=c(this).data("contextMenu")||{};if(b.$selected){var e=b.$selected,b=b.$selected.parent().data("contextMenu")||{};b.$selected=e}for(var e=b.$menu.children(),d=b.$selected&&b.$selected.next().length?b.$selected.next():e.first(),f=d;d.hasClass("disabled")||d.hasClass("not-selectable");)if(d=d.next().length?d.next():e.first(),d.is(f))return;b.$selected&&k.itemMouseleave.call(b.$selected.get(0),a);k.itemMouseenter.call(d.get(0),a);a=d.find("input, textarea, select");a.length&&a.focus()},focusInput:function(a){a=c(this).closest(".context-menu-item");var b=a.data(),e=b.contextMenu,b=b.contextMenuRoot;b.$selected=e.$selected=a;b.isInput=e.isInput=!0},blurInput:function(a){a=c(this).closest(".context-menu-item").data();a.contextMenuRoot.isInput=a.contextMenu.isInput=!1},menuMouseenter:function(a){c(this).data().contextMenuRoot.hovering=!0},menuMouseleave:function(a){var b=c(this).data().contextMenuRoot;b.$layer&&b.$layer.is(a.relatedTarget)&&(b.hovering=!1)},itemMouseenter:function(a){var b=c(this),e=b.data(),d=e.contextMenu,e=e.contextMenuRoot;e.hovering=!0;a&&e.$layer&&e.$layer.is(a.relatedTarget)&&(a.preventDefault(),a.stopImmediatePropagation());(d.$menu?d:e).$menu.children(".hover").trigger("contextmenu:blur");b.hasClass("disabled")||b.hasClass("not-selectable")?d.$selected=null:b.trigger("contextmenu:focus")},itemMouseleave:function(a){var b=c(this),e=b.data(),d=e.contextMenu,e=e.contextMenuRoot;e!==d&&e.$layer&&e.$layer.is(a.relatedTarget)?(e.$selected&&e.$selected.trigger("contextmenu:blur"),a.preventDefault(),a.stopImmediatePropagation(),e.$selected=d.$selected=d.$node):b.trigger("contextmenu:blur")},itemClick:function(a){var b=c(this),e=b.data(),d=e.contextMenuRoot,f=e.contextMenuKey;if(e.contextMenu.items[f]&&!b.is(".disabled, .context-menu-submenu, .context-menu-separator, .not-selectable")){a.preventDefault();a.stopImmediatePropagation();if(c.isFunction(d.callbacks[f])&&Object.prototype.hasOwnProperty.call(d.callbacks,f))a=d.callbacks[f];else if(c.isFunction(d.callback))a=d.callback;else return;!1!==a.call(d.$trigger,f,d)?d.$menu.trigger("contextmenu:hide"):d.$menu.parent().length&&l.update.call(d.$trigger,d)}},inputClick:function(a){a.stopImmediatePropagation()},hideMenu:function(a,b){var e=c(this).data("contextMenuRoot");l.hide.call(e.$trigger,e,b&&b.force)},focusItem:function(a){a.stopPropagation();a=c(this);var b=a.data(),e=b.contextMenu,b=b.contextMenuRoot;a.addClass("hover").siblings(".hover").trigger("contextmenu:blur");e.$selected=b.$selected=a;e.$node&&b.positionSubmenu.call(e.$node,e.$menu)},blurItem:function(a){a.stopPropagation();a=c(this);var b=a.data().contextMenu;a.removeClass("hover");b.$selected=null}},l={show:function(a,b,e){var d=c(this),f={};c("#context-menu-layer").trigger("mousedown");a.$trigger=d;if(!1===a.events.show.call(d,a))n=null;else if(l.update.call(d,a),a.position.call(d,a,b,e),a.zIndex&&(f.zIndex=v(d)+a.zIndex),l.layer.call(a.$menu,a,f.zIndex),a.$menu.find("ul").css("zIndex",f.zIndex+1),a.$menu.css(f)[a.animation.show](a.animation.duration,function(){d.trigger("contextmenu:visible")}),d.data("contextMenu",a).addClass("context-menu-active"),c(document).off("keydown.contextMenu").on("keydown.contextMenu",k.key),a.autoHide)c(document).on("mousemove.contextMenuAutoHide",function(b){var c=d.offset();c.right=c.left+d.outerWidth();c.bottom=c.top+d.outerHeight();!a.$layer||a.hovering||b.pageX>=c.left&&b.pageX<=c.right&&b.pageY>=c.top&&b.pageY<=c.bottom||a.$menu.trigger("contextmenu:hide")})},hide:function(a,b){var e=c(this);a||(a=e.data("contextMenu")||{});if(b||!a.events||!1!==a.events.hide.call(e,a)){e.removeData("contextMenu").removeClass("context-menu-active");if(a.$layer){setTimeout(function(a){return function(){a.remove()}}(a.$layer),10);try{delete a.$layer}catch(d){a.$layer=null}}n=null;a.$menu.find(".hover").trigger("contextmenu:blur");a.$selected=null;c(document).off(".contextMenuAutoHide").off("keydown.contextMenu");a.$menu&&a.$menu[a.animation.hide](a.animation.duration,function(){a.build&&(a.$menu.remove(),c.each(a,function(b,c){switch(b){case "ns":case "selector":case "build":case "trigger":return!0;default:a[b]=s;try{delete a[b]}catch(d){}return!0}}));setTimeout(function(){e.trigger("contextmenu:hidden")},10)})}},create:function(a,b){b===s&&(b=a);a.$menu=c('<ul class="context-menu-list"></ul>').addClass(a.className||"").data({contextMenu:a,contextMenuRoot:b});c.each(["callbacks","commands","inputs"],function(c,d){a[d]={};b[d]||(b[d]={})});b.accesskeys||(b.accesskeys={});c.each(a.items,function(e,d){var f=c('<li class="context-menu-item"></li>').addClass(d.className||""),g=null,h=null;f.on("click",c.noop);d.$node=f.data({contextMenu:a,contextMenuRoot:b,contextMenuKey:e});if(d.accesskey)for(var m=E(d.accesskey),n=0,p;p=m[n];n++)if(!b.accesskeys[p]){b.accesskeys[p]=d;d._name=d.name.replace(RegExp("("+p+")","i"),'<span class="context-menu-accesskey">$1</span>');break}if("string"==typeof d)f.addClass("context-menu-separator not-selectable");else if(d.type&&y[d.type])y[d.type].call(f,d,a,b),c.each([a,b],function(a,b){b.commands[e]=d;c.isFunction(d.callback)&&(b.callbacks[e]=d.callback)});else{"html"==d.type?f.addClass("context-menu-html not-selectable"):d.type?(g=c("<label></label>").appendTo(f),c("<span></span>").html(d._name||d.name).appendTo(g),f.addClass("context-menu-input"),a.hasTypes=!0,c.each([a,b],function(a,b){b.commands[e]=d;b.inputs[e]=d})):d.items&&(d.type="sub");switch(d.type){case "text":h=c('<input type="text" value="1" name="" value="">').attr("name","context-menu-input-"+e).val(d.value||"").appendTo(g);break;case "textarea":h=c('<textarea name=""></textarea>').attr("name","context-menu-input-"+e).val(d.value||"").appendTo(g);d.height&&h.height(d.height);break;case "checkbox":h=c('<input type="checkbox" value="1" name="" value="">').attr("name","context-menu-input-"+e).val(d.value||"").prop("checked",!!d.selected).prependTo(g);break;case "radio":h=c('<input type="radio" value="1" name="" value="">').attr("name","context-menu-input-"+d.radio).val(d.value||"").prop("checked",!!d.selected).prependTo(g);break;case "select":h=c('<select name="">').attr("name","context-menu-input-"+e).appendTo(g);d.options&&(c.each(d.options,function(a,b){c("<option></option>").val(a).text(b).appendTo(h)}),h.val(d.selected));break;case "sub":c("<span></span>").html(d._name||d.name).appendTo(f);d.appendTo=d.$node;l.create(d,b);f.data("contextMenu",d).addClass("context-menu-submenu");d.callback=null;break;case "html":c(d.html).appendTo(f);break;default:c.each([a,b],function(a,b){b.commands[e]=d;c.isFunction(d.callback)&&(b.callbacks[e]=d.callback)}),c("<span></span>").html(d._name||d.name||"").appendTo(f)}if(d.type&&"sub"!=d.type&&"html"!=d.type&&(h.on("focus",k.focusInput).on("blur",k.blurInput),d.events))h.on(d.events,a);d.icon&&f.addClass("icon icon-"+d.icon)}d.$input=h;d.$label=g;f.appendTo(a.$menu);if(!a.hasTypes&&c.support.eventSelectstart)f.on("selectstart.disableTextSelect",k.abortevent)});a.$node||a.$menu.css("display","none").addClass("context-menu-root");a.$menu.appendTo(a.appendTo||document.body)},resize:function(a,b){a.css({position:"absolute",display:"block"});a.data("width",Math.ceil(a.width())+1);a.css({position:"static",minWidth:"0px",maxWidth:"100000px"});a.find("> li > ul").each(function(){l.resize(c(this),!0)});b||a.find("ul").andSelf().css({position:"",display:"",minWidth:"",maxWidth:""}).width(function(){return c(this).data("width")})},update:function(a,b){var e=this;b===s&&(b=a,l.resize(a.$menu));a.$menu.children().each(function(){var d=c(this),f=d.data("contextMenuKey"),g=a.items[f],f=c.isFunction(g.disabled)&&g.disabled.call(e,f,b)||!0===g.disabled;d[f?"addClass":"removeClass"]("disabled");if(g.type)switch(d.find("input, select, textarea").prop("disabled",f),g.type){case "text":case "textarea":g.$input.val(g.value||"");break;case "checkbox":case "radio":g.$input.val(g.value||"").prop("checked",!!g.selected);break;case "select":g.$input.val(g.selected||"")}g.$menu&&l.update.call(e,g,b)})},layer:function(a,b){var e=a.$layer=c('<div id="context-menu-layer" style="position:fixed; z-index:'+b+'; top:0; left:0; opacity: 0; filter: alpha(opacity=0); background-color: #000;"></div>').css({height:t.height(),width:t.width(),display:"block"}).data("contextMenuRoot",a).insertBefore(this).on("contextmenu",k.abortevent).on("mousedown",k.layerClick);c.support.fixedPosition||e.css({position:"absolute",height:c(document).height()});return e}};c.fn.contextMenu=function(a){a===s?this.first().trigger("contextmenu"):a.x&&a.y?this.first().trigger(c.Event("contextmenu",{pageX:a.x,pageY:a.y})):"hide"===a?(a=this.data("contextMenu").$menu)&&a.trigger("contextmenu:hide"):"destroy"===a?c.contextMenu("destroy",{context:this}):c.isPlainObject(a)?(a.context=this,c.contextMenu("create",a)):a?this.removeClass("context-menu-disabled"):a||this.addClass("context-menu-disabled");return this};c.contextMenu=function(a,b){"string"!=typeof a&&(b=a,a="create");"string"==typeof b?b={selector:b}:b===s&&(b={});var e=c.extend(!0,{},D,b||{}),d=c(document),f=d,g=!1;e.context&&e.context.length?(f=c(e.context).first(),e.context=f.get(0),g=e.context!==document):e.context=document;switch(a){case "create":if(!e.selector)throw Error("No selector specified");if(e.selector.match(/.context-menu-(list|item|input)($|\s)/))throw Error('Cannot bind to selector "'+e.selector+'" as it contains a reserved className');if(!e.build&&(!e.items||c.isEmptyObject(e.items)))throw Error("No Items sepcified");C++;e.ns=".contextMenu"+C;g||(r[e.selector]=e.ns);p[e.ns]=e;e.trigger||(e.trigger="right");B||(d.on({"contextmenu:hide.contextMenu":k.hideMenu,"prevcommand.contextMenu":k.prevItem,"nextcommand.contextMenu":k.nextItem,"contextmenu.contextMenu":k.abortevent,"mouseenter.contextMenu":k.menuMouseenter,"mouseleave.contextMenu":k.menuMouseleave},".context-menu-list").on("mouseup.contextMenu",".context-menu-input",k.inputClick).on({"mouseup.contextMenu":k.itemClick,"contextmenu:focus.contextMenu":k.focusItem,"contextmenu:blur.contextMenu":k.blurItem,"contextmenu.contextMenu":k.abortevent,"mouseenter.contextMenu":k.itemMouseenter,"mouseleave.contextMenu":k.itemMouseleave},".context-menu-item"),B=!0);f.on("contextmenu"+e.ns,e.selector,e,k.contextmenu);if(g)f.on("remove"+e.ns,function(){c(this).contextMenu("destroy")});switch(e.trigger){case "hover":f.on("mouseenter"+e.ns,e.selector,e,k.mouseenter).on("mouseleave"+e.ns,e.selector,e,k.mouseleave);break;case "left":f.on("click"+e.ns,e.selector,e,k.click)}e.build||l.create(e);break;case "destroy":var h;if(g){var m=e.context;c.each(p,function(a,b){if(b.context!==m)return!0;h=c(".context-menu-list").filter(":visible");h.length&&h.data().contextMenuRoot.$trigger.is(c(b.context).find(b.selector))&&h.trigger("contextmenu:hide",{force:!0});try{p[b.ns].$menu&&p[b.ns].$menu.remove(),delete p[b.ns]}catch(d){p[b.ns]=null}c(b.context).off(b.ns);return!0})}else if(!e.selector)d.off(".contextMenu .contextMenuAutoHide"),c.each(p,function(b,a){c(a.context).off(a.ns)}),r={},p={},C=0,B=!1,c("#context-menu-layer, .context-menu-list").remove();else if(r[e.selector]){h=c(".context-menu-list").filter(":visible");h.length&&h.data().contextMenuRoot.$trigger.is(e.selector)&&h.trigger("contextmenu:hide",{force:!0});try{p[r[e.selector]].$menu&&p[r[e.selector]].$menu.remove(),delete p[r[e.selector]]}catch(n){p[r[e.selector]]=null}d.off(r[e.selector])}break;case "html5":(!c.support.htmlCommand&&!c.support.htmlMenuitem||"boolean"==typeof b&&b)&&c('menu[type="context"]').each(function(){this.id&&c.contextMenu({selector:"[contextmenu="+this.id+"]",items:c.contextMenu.fromMenu(this)})}).css("display","none");break;default:throw Error('Unknown operation "'+a+'"');}return this};c.contextMenu.setInputValues=function(a,b){b===s&&(b={});c.each(a.inputs,function(a,c){switch(c.type){case "text":case "textarea":c.value=b[a]||"";break;case "checkbox":c.selected=b[a]?!0:!1;break;case "radio":c.selected=(b[c.radio]||"")==c.value?!0:!1;break;case "select":c.selected=b[a]||""}})};c.contextMenu.getInputValues=function(a,b){b===s&&(b={});c.each(a.inputs,function(a,c){switch(c.type){case "text":case "textarea":case "select":b[a]=c.$input.val();break;case "checkbox":b[a]=c.$input.prop("checked");break;case "radio":c.$input.prop("checked")&&(b[c.radio]=c.value)}});return b};c.contextMenu.fromMenu=function(a){a=c(a);var b={};z(b,a.children());return b};c.contextMenu.defaults=D;c.contextMenu.types=y;c.contextMenu.handle=k;c.contextMenu.op=l;c.contextMenu.menus=p})(jQuery);